<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video.js Player Test - Seeking & ë°°ì†</title>

    <!-- Video.js 7.x CDN (í”„ë¡œì íŠ¸ì™€ ë™ì¼ ë²„ì „) -->
    <link href="https://vjs.zencdn.net/7.8.2/video-js.css" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Malgun Gothic', sans-serif;
            background: #1a1a2e;
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin-bottom: 10px;
            color: #00d4ff;
        }

        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 30px;
        }

        /* í”Œë ˆì´ì–´ ì˜ì—­ */
        .player-wrapper {
            position: relative;
            background: #000;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        .video-js {
            width: 100%;
            height: 450px;
        }

        /* ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
        .control-panel {
            background: #16213e;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .control-section {
            margin-bottom: 20px;
        }

        .control-section:last-child {
            margin-bottom: 0;
        }

        .control-section h3 {
            color: #00d4ff;
            margin-bottom: 15px;
            font-size: 16px;
            border-bottom: 1px solid #0f3460;
            padding-bottom: 8px;
        }

        /* ë°°ì† ë²„íŠ¼ */
        .speed-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .speed-btn {
            padding: 10px 20px;
            border: 2px solid #0f3460;
            background: transparent;
            color: #fff;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .speed-btn:hover {
            background: #0f3460;
        }

        .speed-btn.active {
            background: #00d4ff;
            border-color: #00d4ff;
            color: #000;
        }

        /* Seeking í…ŒìŠ¤íŠ¸ */
        .seek-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .seek-btn {
            padding: 10px 15px;
            background: #e94560;
            border: none;
            color: #fff;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s;
        }

        .seek-btn:hover {
            background: #ff6b6b;
        }

        .seek-btn.allow {
            background: #4caf50;
        }

        .seek-btn.allow:hover {
            background: #66bb6a;
        }

        /* í† ê¸€ ìŠ¤ìœ„ì¹˜ */
        .toggle-wrapper {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 10px;
        }

        .toggle-switch {
            position: relative;
            width: 60px;
            height: 30px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #e94560;
            transition: 0.4s;
            border-radius: 30px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: 0.4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: #4caf50;
        }

        input:checked + .toggle-slider:before {
            transform: translateX(30px);
        }

        .toggle-label {
            font-size: 14px;
        }

        /* ë¡œê·¸ ì˜ì—­ */
        .log-section {
            background: #0f0f23;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
        }

        .log-section h3 {
            color: #00d4ff;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .log-content {
            font-family: 'Consolas', monospace;
            font-size: 12px;
            line-height: 1.6;
        }

        .log-item {
            padding: 3px 0;
            border-bottom: 1px solid #1a1a2e;
        }

        .log-item.seeking {
            color: #ffc107;
        }

        .log-item.blocked {
            color: #e94560;
        }

        .log-item.speed {
            color: #00d4ff;
        }

        .log-item.info {
            color: #4caf50;
        }

        /* ìƒíƒœ í‘œì‹œ */
        .status-bar {
            display: flex;
            gap: 20px;
            margin-top: 15px;
            padding: 15px;
            background: #0f3460;
            border-radius: 6px;
            flex-wrap: wrap;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-label {
            color: #888;
            font-size: 13px;
        }

        .status-value {
            color: #00d4ff;
            font-weight: bold;
            font-size: 14px;
        }

        /* ì…ë ¥ ì†ŒìŠ¤ */
        .source-input {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .source-input input {
            flex: 1;
            padding: 10px 15px;
            border: 2px solid #0f3460;
            background: #0f0f23;
            color: #fff;
            border-radius: 6px;
            font-size: 13px;
        }

        .source-input button {
            padding: 10px 20px;
            background: #00d4ff;
            border: none;
            color: #000;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }

        .sample-sources {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 10px;
        }

        .sample-btn {
            padding: 6px 12px;
            background: #0f3460;
            border: none;
            color: #fff;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .sample-btn:hover {
            background: #16213e;
        }

        /* ëª¨ë°”ì¼ ëŒ€ì‘ */
        @media (max-width: 600px) {
            .video-js {
                height: 250px;
            }

            .speed-buttons {
                justify-content: center;
            }

            .status-bar {
                flex-direction: column;
                gap: 10px;
            }
        }

        /* CSS ê¸°ë°˜ ê°€ìƒ ì „ì²´í™”ë©´ */
        .fake-fullscreen {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            right: 0 !important;
            bottom: 0 !important;
            width: 100% !important;
            height: 100% !important;
            max-width: 100% !important;
            max-height: 100% !important;
            z-index: 99999 !important;
            background: #000 !important;
            margin: 0 !important;
            padding: 0 !important;
            border-radius: 0 !important;
            overflow: hidden !important;
        }

        .fake-fullscreen .video-js {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            max-width: 100% !important;
            max-height: 100% !important;
        }

        .fake-fullscreen video {
            object-fit: contain !important;
        }

        /* ê°€ìƒ ì „ì²´í™”ë©´ ì¢…ë£Œ ë²„íŠ¼ */
        .fake-fullscreen-exit {
            position: fixed;
            top: 15px;
            right: 15px;
            z-index: 100000;
            background: rgba(0,0,0,0.7);
            color: #fff;
            border: 2px solid #fff;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
        }

        .fake-fullscreen-exit:hover {
            background: rgba(255,255,255,0.2);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¬ Video.js Player Test</h1>
        <p class="subtitle">Seeking ì œí•œ + ë°°ì† ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ í™˜ê²½ <span style="color:#00d4ff;">v1.3.0</span></p>

        <!-- ë¹„ë””ì˜¤ ì†ŒìŠ¤ ì…ë ¥ -->
        <div class="control-panel" style="margin-bottom: 20px;">
            <div class="control-section">
                <h3>ğŸ“¹ ë¹„ë””ì˜¤ ì†ŒìŠ¤</h3>
                <div class="sample-sources">
                    <button class="sample-btn" onclick="loadSample('hls')">ìƒ˜í”Œ HLS</button>
                    <button class="sample-btn" onclick="loadSample('mp4')">ìƒ˜í”Œ MP4</button>
                    <button class="sample-btn" onclick="loadSample('hana')" style="background:#e94560;">í•˜ë‚˜ HLS (ë‚´ë¶€ë§)</button>
                </div>
                <div class="source-input">
                    <input type="text" id="videoSource" placeholder="HLS URL (m3u8) ë˜ëŠ” MP4 URL ì…ë ¥">
                    <button onclick="loadVideo()">ë¡œë“œ</button>
                </div>
            </div>
        </div>

        <!-- í”Œë ˆì´ì–´ -->
        <div class="player-wrapper">
            <video id="my-player" class="video-js vjs-big-play-centered vjs-fluid">
                <p class="vjs-no-js">JavaScriptë¥¼ í™œì„±í™”í•´ì£¼ì„¸ìš”.</p>
            </video>
        </div>

        <!-- ìƒíƒœ í‘œì‹œ -->
        <div class="status-bar">
            <div class="status-item">
                <span class="status-label">í˜„ì¬ ì‹œê°„:</span>
                <span class="status-value" id="currentTime">0:00</span>
            </div>
            <div class="status-item">
                <span class="status-label">ì „ì²´ ì‹œê°„:</span>
                <span class="status-value" id="duration">0:00</span>
            </div>
            <div class="status-item">
                <span class="status-label">ë°°ì†:</span>
                <span class="status-value" id="currentSpeed">1.0x</span>
            </div>
            <div class="status-item">
                <span class="status-label">ìµœëŒ€ ì‹œì²­ ìœ„ì¹˜:</span>
                <span class="status-value" id="maxWatched">0:00</span>
            </div>
            <div class="status-item">
                <span class="status-label">Seeking ì œí•œ:</span>
                <span class="status-value" id="seekStatus">OFF</span>
            </div>
        </div>

        <!-- ì»¨íŠ¸ë¡¤ íŒ¨ë„ -->
        <div class="control-panel">
            <!-- ë°°ì† ì„¤ì • -->
            <div class="control-section">
                <h3>âš¡ ë°°ì† ì„¤ì •</h3>
                <div class="speed-buttons">
                    <button class="speed-btn" data-speed="0.5">0.5x</button>
                    <button class="speed-btn" data-speed="0.75">0.75x</button>
                    <button class="speed-btn active" data-speed="1">1.0x</button>
                    <button class="speed-btn" data-speed="1.2">1.2x</button>
                    <button class="speed-btn" data-speed="1.5">1.5x</button>
                    <button class="speed-btn" data-speed="1.75">1.75x</button>
                    <button class="speed-btn" data-speed="2">2.0x</button>
                </div>
            </div>

            <!-- Seeking ì œí•œ ì„¤ì • -->
            <div class="control-section">
                <h3>ğŸ”’ Seeking ì œí•œ ì„¤ì •</h3>
                <div class="toggle-wrapper">
                    <label class="toggle-switch">
                        <input type="checkbox" id="seekRestrict" onchange="toggleSeekRestriction()">
                        <span class="toggle-slider"></span>
                    </label>
                    <span class="toggle-label">ì•ìœ¼ë¡œ íƒìƒ‰ ì œí•œ (ì‹œì²­í•˜ì§€ ì•Šì€ êµ¬ê°„ìœ¼ë¡œ ì´ë™ ì°¨ë‹¨)</span>
                </div>

                <div class="seek-controls" style="margin-top: 15px;">
                    <button class="seek-btn" onclick="testSeek(-10)">â—€ 10ì´ˆ ë’¤ë¡œ</button>
                    <button class="seek-btn allow" onclick="testSeek(10)">10ì´ˆ ì•ìœ¼ë¡œ â–¶</button>
                    <button class="seek-btn" onclick="testSeek(-30)">â—€ 30ì´ˆ ë’¤ë¡œ</button>
                    <button class="seek-btn allow" onclick="testSeek(30)">30ì´ˆ ì•ìœ¼ë¡œ â–¶</button>
                    <button class="seek-btn" onclick="seekToEnd()">ëìœ¼ë¡œ ì´ë™</button>
                    <button class="seek-btn" onclick="resetMaxWatched()">ì‹œì²­ ê¸°ë¡ ì´ˆê¸°í™”</button>
                </div>
            </div>

            <!-- ëª¨ë°”ì¼ ì „ì²´í™”ë©´ -->
            <div class="control-section" id="mobileFullscreenSection" style="display:none;">
                <h3>ğŸ“± ëª¨ë°”ì¼ ì „ì²´í™”ë©´</h3>
                <p style="color:#888; font-size:13px; margin-bottom:10px;">Video.js ì „ì²´í™”ë©´ ë²„íŠ¼ì´ ë¹„í™œì„±í™”ë  ê²½ìš° ì•„ë˜ ë²„íŠ¼ ì‚¬ìš©</p>
                <div class="speed-buttons">
                    <button class="seek-btn allow" onclick="enterMobileFullscreen()" style="background:#00d4ff; color:#000;">
                        ğŸ“º ì „ì²´í™”ë©´ ì§„ì…
                    </button>
                    <button class="seek-btn" onclick="exitMobileFullscreen()">
                        âœ– ì „ì²´í™”ë©´ ì¢…ë£Œ
                    </button>
                </div>
            </div>
        </div>

        <!-- ë¡œê·¸ -->
        <div class="log-section">
            <h3>ğŸ“‹ ì´ë²¤íŠ¸ ë¡œê·¸</h3>
            <div class="log-content" id="logContent"></div>
        </div>
    </div>

    <!-- Video.js ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://vjs.zencdn.net/7.8.2/video.min.js"></script>

    <script>
        // ========================================
        // í”Œë ˆì´ì–´ ì´ˆê¸°í™”
        // ========================================
        var player = null;
        var maxWatchedTime = 0;        // ìµœëŒ€ ì‹œì²­ ìœ„ì¹˜
        var seekRestrictionEnabled = false;  // Seeking ì œí•œ í™œì„±í™” ì—¬ë¶€
        var lastKnownTime = 0;         // ë§ˆì§€ë§‰ ì•Œë ¤ì§„ ì‹œê°„ (seeking ê°ì§€ìš©)

        // ìƒ˜í”Œ ë¹„ë””ì˜¤ URL
        var sampleVideos = {
            hls: 'https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8',
            mp4: 'https://www.w3schools.com/html/mov_bbb.mp4',
            hana: 'http://210.107.66.36:1935/vod/_definst_/2019/2019319132039/2019319132039.mp4/playlist.m3u8'
        };

        // í”Œë ˆì´ì–´ ì´ˆê¸°í™”
        // ëª¨ë°”ì¼ ê°ì§€
        var isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
        var isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);

        function initPlayer() {
            player = videojs('my-player', {
                controls: true,
                autoplay: false,
                preload: 'auto',
                fluid: true,
                playbackRates: [0.5, 0.75, 1, 1.2, 1.5, 1.75, 2],
                // iOS ì „ì²´í™”ë©´ ì§€ì›
                playsinline: !isIOS,  // iOSì—ì„œëŠ” playsinline ë¹„í™œì„±í™”í•˜ì—¬ ë„¤ì´í‹°ë¸Œ ì „ì²´í™”ë©´ í—ˆìš©
                html5: {
                    vhs: {
                        overrideNative: true
                    },
                    nativeAudioTracks: false,
                    nativeVideoTracks: false,
                    nativeFullscreen: isIOS  // iOSì—ì„œ ë„¤ì´í‹°ë¸Œ ì „ì²´í™”ë©´ ì‚¬ìš©
                }
            });

            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
            player.on('loadedmetadata', onLoadedMetadata);
            player.on('timeupdate', onTimeUpdate);
            player.on('seeking', onSeeking);
            player.on('seeked', onSeeked);
            player.on('ratechange', onRateChange);
            player.on('play', function() { addLog('â–¶ ì¬ìƒ ì‹œì‘', 'info'); });
            player.on('pause', function() { addLog('â¸ ì¼ì‹œ ì •ì§€', 'info'); });
            player.on('ended', function() { addLog('â¹ ì¬ìƒ ì™„ë£Œ', 'info'); });
            player.on('error', function() { addLog('âŒ ì—ëŸ¬ ë°œìƒ: ' + player.error().message, 'blocked'); });

            // ëª¨ë°”ì¼ ì „ì²´í™”ë©´ ì§€ì›
            var videoEl = player.tech().el();
            var playerContainer = document.querySelector('.player-wrapper');
            var isFakeFullscreen = false;

            // ê°€ìƒ ì „ì²´í™”ë©´ ì§„ì…
            function enterFakeFullscreen() {
                playerContainer.classList.add('fake-fullscreen');

                // ì¢…ë£Œ ë²„íŠ¼ ì¶”ê°€
                var exitBtn = document.createElement('button');
                exitBtn.className = 'fake-fullscreen-exit';
                exitBtn.id = 'fakeFullscreenExit';
                exitBtn.textContent = 'âœ– ì „ì²´í™”ë©´ ì¢…ë£Œ';
                exitBtn.onclick = exitFakeFullscreen;
                playerContainer.appendChild(exitBtn);

                isFakeFullscreen = true;
                addLog('CSS ê°€ìƒ ì „ì²´í™”ë©´ ì§„ì…', 'info');

                // í™”ë©´ ë°©í–¥ ê°€ë¡œ ê³ ì • ì‹œë„ (ì§€ì›ë˜ëŠ” ê²½ìš°)
                if (screen.orientation && screen.orientation.lock) {
                    screen.orientation.lock('landscape').catch(function(e) {
                        // ë¬´ì‹œ - ì§€ì› ì•ˆ ë  ìˆ˜ ìˆìŒ
                    });
                }
            }

            // ê°€ìƒ ì „ì²´í™”ë©´ ì¢…ë£Œ
            function exitFakeFullscreen() {
                playerContainer.classList.remove('fake-fullscreen');
                var exitBtn = document.getElementById('fakeFullscreenExit');
                if (exitBtn) exitBtn.remove();
                isFakeFullscreen = false;
                addLog('CSS ê°€ìƒ ì „ì²´í™”ë©´ ì¢…ë£Œ', 'info');

                // í™”ë©´ ë°©í–¥ í•´ì œ
                if (screen.orientation && screen.orientation.unlock) {
                    screen.orientation.unlock();
                }
            }

            // ì»¤ìŠ¤í…€ ì „ì²´í™”ë©´ í•¨ìˆ˜ (iOS/Android ëª¨ë‘ ì§€ì›)
            window.enterMobileFullscreen = function() {
                addLog('ì „ì²´í™”ë©´ ì‹œë„...', 'info');

                // 1. iOS ë„¤ì´í‹°ë¸Œ ë¹„ë””ì˜¤ ì „ì²´í™”ë©´
                if (isIOS && videoEl.webkitEnterFullscreen) {
                    try {
                        videoEl.webkitEnterFullscreen();
                        addLog('iOS webkitEnterFullscreen ì„±ê³µ', 'info');
                        return;
                    } catch(e) {
                        addLog('iOS ì „ì²´í™”ë©´ ì‹¤íŒ¨: ' + e.message, 'blocked');
                    }
                }

                // 2. í‘œì¤€ Fullscreen API (Android Chrome ë“±)
                var elem = playerContainer || videoEl;
                var fullscreenSupported = elem.requestFullscreen || elem.webkitRequestFullscreen ||
                                          elem.mozRequestFullScreen || elem.msRequestFullscreen;

                if (elem.requestFullscreen) {
                    elem.requestFullscreen().then(function() {
                        addLog('requestFullscreen ì„±ê³µ', 'info');
                    }).catch(function(e) {
                        addLog('requestFullscreen ì‹¤íŒ¨: ' + e.message + ' â†’ CSS ì „ì²´í™”ë©´ ì‚¬ìš©', 'seeking');
                        enterFakeFullscreen();
                    });
                } else if (elem.webkitRequestFullscreen) {
                    elem.webkitRequestFullscreen();
                    addLog('webkitRequestFullscreen í˜¸ì¶œ', 'info');
                } else if (elem.mozRequestFullScreen) {
                    elem.mozRequestFullScreen();
                    addLog('mozRequestFullScreen í˜¸ì¶œ', 'info');
                } else if (elem.msRequestFullscreen) {
                    elem.msRequestFullscreen();
                    addLog('msRequestFullscreen í˜¸ì¶œ', 'info');
                } else {
                    // Fullscreen API ë¯¸ì§€ì› â†’ CSS ê°€ìƒ ì „ì²´í™”ë©´ ì‚¬ìš©
                    addLog('Fullscreen API ë¯¸ì§€ì› â†’ CSS ì „ì²´í™”ë©´ ì‚¬ìš©', 'seeking');
                    enterFakeFullscreen();
                }
            };

            // ì „ì²´í™”ë©´ ì¢…ë£Œ í•¨ìˆ˜
            window.exitMobileFullscreen = function() {
                // ê°€ìƒ ì „ì²´í™”ë©´ì¸ ê²½ìš°
                if (isFakeFullscreen) {
                    exitFakeFullscreen();
                    return;
                }

                // ë„¤ì´í‹°ë¸Œ ì „ì²´í™”ë©´ ì¢…ë£Œ
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.mozCancelFullScreen) {
                    document.mozCancelFullScreen();
                }
            };

            if (isMobile) {
                addLog((isIOS ? 'iOS' : 'Android') + ' ê°ì§€ë¨ - ì»¤ìŠ¤í…€ ì „ì²´í™”ë©´ ë²„íŠ¼ ì‚¬ìš©', 'info');

                // í™”ë©´ íšŒì „ ì‹œ ê°€ìƒ ì „ì²´í™”ë©´ ìœ ì§€
                window.addEventListener('orientationchange', function() {
                    if (isFakeFullscreen) {
                        addLog('í™”ë©´ íšŒì „ ê°ì§€ - ì „ì²´í™”ë©´ ìœ ì§€', 'seeking');
                        // ì•½ê°„ì˜ ë”œë ˆì´ í›„ í¬ê¸° ì¬ì¡°ì •
                        setTimeout(function() {
                            player.dimensions('100%', '100%');
                        }, 100);
                    }
                });

                // resize ì´ë²¤íŠ¸ì—ì„œë„ ê°€ìƒ ì „ì²´í™”ë©´ ìœ ì§€
                window.addEventListener('resize', function() {
                    if (isFakeFullscreen) {
                        player.dimensions('100%', '100%');
                    }
                });
            }

            addLog('í”Œë ˆì´ì–´ ì´ˆê¸°í™” ì™„ë£Œ (Video.js 7.8.2)' + (isMobile ? ' [ëª¨ë°”ì¼]' : ''), 'info');
        }

        // ========================================
        // ë¹„ë””ì˜¤ ë¡œë“œ
        // ========================================
        function loadVideo() {
            var url = document.getElementById('videoSource').value.trim();
            if (!url) {
                addLog('URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'blocked');
                return;
            }

            var type = url.includes('.m3u8') ? 'application/x-mpegURL' : 'video/mp4';

            player.src({
                src: url,
                type: type
            });

            // ì´ˆê¸°í™”
            maxWatchedTime = 0;
            lastKnownTime = 0;
            updateStatus();

            addLog('ë¹„ë””ì˜¤ ë¡œë“œ: ' + url, 'info');
        }

        function loadSample(type) {
            document.getElementById('videoSource').value = sampleVideos[type] || '';
            loadVideo();
        }

        // ========================================
        // ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
        // ========================================
        function onLoadedMetadata() {
            updateStatus();
            addLog('ë©”íƒ€ë°ì´í„° ë¡œë“œ ì™„ë£Œ - ê¸¸ì´: ' + formatTime(player.duration()), 'info');
        }

        function onTimeUpdate() {
            var currentTime = player.currentTime();

            // ìµœëŒ€ ì‹œì²­ ìœ„ì¹˜ ì—…ë°ì´íŠ¸ (ì •ìƒ ì¬ìƒ ì‹œì—ë§Œ)
            if (!player.seeking() && currentTime > maxWatchedTime) {
                maxWatchedTime = currentTime;
            }

            lastKnownTime = currentTime;
            updateStatus();
        }

        function onSeeking() {
            var targetTime = player.currentTime();
            addLog('Seeking ì‹œë„: ' + formatTime(lastKnownTime) + ' â†’ ' + formatTime(targetTime), 'seeking');

            // Seeking ì œí•œì´ í™œì„±í™”ëœ ê²½ìš°
            if (seekRestrictionEnabled && targetTime > maxWatchedTime) {
                // ì‹œì²­í•˜ì§€ ì•Šì€ êµ¬ê°„ìœ¼ë¡œ ì´ë™ ì‹œë„ - ì°¨ë‹¨
                addLog('â›” Seeking ì°¨ë‹¨! ìµœëŒ€ ì‹œì²­ ìœ„ì¹˜(' + formatTime(maxWatchedTime) + ')ë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'blocked');

                // ìµœëŒ€ ì‹œì²­ ìœ„ì¹˜ë¡œ ë˜ëŒë¦¼
                player.currentTime(maxWatchedTime);
            }
        }

        function onSeeked() {
            var currentTime = player.currentTime();
            addLog('Seeking ì™„ë£Œ: ' + formatTime(currentTime), 'info');
        }

        function onRateChange() {
            var rate = player.playbackRate();
            updateSpeedButtons(rate);
            updateStatus();
            addLog('ë°°ì† ë³€ê²½: ' + rate + 'x', 'speed');
        }

        // ========================================
        // ë°°ì† ì»¨íŠ¸ë¡¤
        // ========================================
        function updateSpeedButtons(rate) {
            document.querySelectorAll('.speed-btn').forEach(function(btn) {
                btn.classList.remove('active');
                if (parseFloat(btn.dataset.speed) === rate) {
                    btn.classList.add('active');
                }
            });
            document.getElementById('currentSpeed').textContent = rate + 'x';
        }

        // ë°°ì† ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
        document.querySelectorAll('.speed-btn').forEach(function(btn) {
            btn.addEventListener('click', function() {
                var speed = parseFloat(this.dataset.speed);
                if (player) {
                    player.playbackRate(speed);
                }
            });
        });

        // ========================================
        // Seeking ì œí•œ í† ê¸€
        // ========================================
        function toggleSeekRestriction() {
            seekRestrictionEnabled = document.getElementById('seekRestrict').checked;
            document.getElementById('seekStatus').textContent = seekRestrictionEnabled ? 'ON' : 'OFF';
            document.getElementById('seekStatus').style.color = seekRestrictionEnabled ? '#e94560' : '#4caf50';
            addLog('Seeking ì œí•œ: ' + (seekRestrictionEnabled ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'), seekRestrictionEnabled ? 'blocked' : 'info');
        }

        // ========================================
        // í…ŒìŠ¤íŠ¸ í•¨ìˆ˜
        // ========================================
        function testSeek(seconds) {
            if (!player) return;
            var targetTime = player.currentTime() + seconds;
            if (targetTime < 0) targetTime = 0;
            if (targetTime > player.duration()) targetTime = player.duration();
            player.currentTime(targetTime);
        }

        function seekToEnd() {
            if (!player) return;
            player.currentTime(player.duration() - 1);
        }

        function resetMaxWatched() {
            maxWatchedTime = 0;
            lastKnownTime = 0;
            updateStatus();
            addLog('ì‹œì²­ ê¸°ë¡ ì´ˆê¸°í™”ë¨', 'info');
        }

        // ========================================
        // ìœ í‹¸ë¦¬í‹°
        // ========================================
        function formatTime(seconds) {
            if (isNaN(seconds) || !isFinite(seconds)) return '0:00';
            var mins = Math.floor(seconds / 60);
            var secs = Math.floor(seconds % 60);
            return mins + ':' + (secs < 10 ? '0' : '') + secs;
        }

        function updateStatus() {
            if (!player) return;
            document.getElementById('currentTime').textContent = formatTime(player.currentTime());
            document.getElementById('duration').textContent = formatTime(player.duration());
            document.getElementById('maxWatched').textContent = formatTime(maxWatchedTime);
        }

        function addLog(message, type) {
            var logContent = document.getElementById('logContent');
            var timestamp = new Date().toLocaleTimeString();
            var logItem = document.createElement('div');
            logItem.className = 'log-item ' + (type || '');
            logItem.textContent = '[' + timestamp + '] ' + message;
            logContent.insertBefore(logItem, logContent.firstChild);

            // ìµœëŒ€ 50ê°œ ë¡œê·¸ ìœ ì§€
            while (logContent.children.length > 50) {
                logContent.removeChild(logContent.lastChild);
            }
        }

        // ========================================
        // ì´ˆê¸°í™”
        // ========================================
        document.addEventListener('DOMContentLoaded', function() {
            initPlayer();

            // ê¸°ë³¸ ìƒ˜í”Œ ë¡œë“œ
            document.getElementById('videoSource').value = sampleVideos.hls;

            // ëª¨ë°”ì¼ì—ì„œ ì „ì²´í™”ë©´ ì„¹ì…˜ í‘œì‹œ
            if (isMobile) {
                document.getElementById('mobileFullscreenSection').style.display = 'block';
            }
        });
    </script>
</body>
</html>
